{"version":3,"names":["_blocks","require","_data","_components","_i18n","_element","_compose","_a11y","_preferences","_lockUnlock","_store","_category","_interopRequireDefault","BlockManager","blockTypes","categories","hasBlockSupport","isMatchingSearchTerm","numberOfHiddenBlocks","enableAllBlockTypes","debouncedSpeak","useDebounce","speak","search","setSearch","useState","filter","blockType","parent","includes","useEffect","count","length","resultsFoundMessage","sprintf","_n","_react","createElement","className","Button","variant","onClick","__","SearchControl","__nextHasNoMarginBottom","label","placeholder","value","onChange","nextSearch","tabIndex","role","map","category","default","key","slug","title","_default","exports","compose","withSelect","select","_get","getBlockTypes","getCategories","blocksStore","get","preferencesStore","hiddenBlockTypes","hiddenBlock","some","registeredBlock","name","Array","isArray","withDispatch","dispatch","showBlockTypes","unlock","editorStore","blockNames"],"sources":["@wordpress/editor/src/components/block-manager/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store as blocksStore } from '@wordpress/blocks';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { SearchControl, Button } from '@wordpress/components';\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { useEffect, useState } from '@wordpress/element';\nimport { useDebounce, compose } from '@wordpress/compose';\nimport { speak } from '@wordpress/a11y';\nimport { store as preferencesStore } from '@wordpress/preferences';\n\n/**\n * Internal dependencies\n */\nimport { unlock } from '../../lock-unlock';\nimport { store as editorStore } from '../../store';\nimport BlockManagerCategory from './category';\n\nfunction BlockManager( {\n\tblockTypes,\n\tcategories,\n\thasBlockSupport,\n\tisMatchingSearchTerm,\n\tnumberOfHiddenBlocks,\n\tenableAllBlockTypes,\n} ) {\n\tconst debouncedSpeak = useDebounce( speak, 500 );\n\tconst [ search, setSearch ] = useState( '' );\n\n\t// Filtering occurs here (as opposed to `withSelect`) to avoid\n\t// wasted renders by consequence of `Array#filter` producing\n\t// a new value reference on each call.\n\tblockTypes = blockTypes.filter(\n\t\t( blockType ) =>\n\t\t\thasBlockSupport( blockType, 'inserter', true ) &&\n\t\t\t( ! search || isMatchingSearchTerm( blockType, search ) ) &&\n\t\t\t( ! blockType.parent ||\n\t\t\t\tblockType.parent.includes( 'core/post-content' ) )\n\t);\n\n\t// Announce search results on change\n\tuseEffect( () => {\n\t\tif ( ! search ) {\n\t\t\treturn;\n\t\t}\n\t\tconst count = blockTypes.length;\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', count ),\n\t\t\tcount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}, [ blockTypes.length, search, debouncedSpeak ] );\n\n\treturn (\n\t\t<div className=\"editor-block-manager__content\">\n\t\t\t{ !! numberOfHiddenBlocks && (\n\t\t\t\t<div className=\"editor-block-manager__disabled-blocks-count\">\n\t\t\t\t\t{ sprintf(\n\t\t\t\t\t\t/* translators: %d: number of blocks. */\n\t\t\t\t\t\t_n(\n\t\t\t\t\t\t\t'%d block is hidden.',\n\t\t\t\t\t\t\t'%d blocks are hidden.',\n\t\t\t\t\t\t\tnumberOfHiddenBlocks\n\t\t\t\t\t\t),\n\t\t\t\t\t\tnumberOfHiddenBlocks\n\t\t\t\t\t) }\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\tonClick={ () => enableAllBlockTypes( blockTypes ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Reset' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t<SearchControl\n\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\tlabel={ __( 'Search for a block' ) }\n\t\t\t\tplaceholder={ __( 'Search for a block' ) }\n\t\t\t\tvalue={ search }\n\t\t\t\tonChange={ ( nextSearch ) => setSearch( nextSearch ) }\n\t\t\t\tclassName=\"editor-block-manager__search\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\ttabIndex=\"0\"\n\t\t\t\trole=\"region\"\n\t\t\t\taria-label={ __( 'Available block types' ) }\n\t\t\t\tclassName=\"editor-block-manager__results\"\n\t\t\t>\n\t\t\t\t{ blockTypes.length === 0 && (\n\t\t\t\t\t<p className=\"editor-block-manager__no-results\">\n\t\t\t\t\t\t{ __( 'No blocks found.' ) }\n\t\t\t\t\t</p>\n\t\t\t\t) }\n\t\t\t\t{ categories.map( ( category ) => (\n\t\t\t\t\t<BlockManagerCategory\n\t\t\t\t\t\tkey={ category.slug }\n\t\t\t\t\t\ttitle={ category.title }\n\t\t\t\t\t\tblockTypes={ blockTypes.filter(\n\t\t\t\t\t\t\t( blockType ) =>\n\t\t\t\t\t\t\t\tblockType.category === category.slug\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t\t<BlockManagerCategory\n\t\t\t\t\ttitle={ __( 'Uncategorized' ) }\n\t\t\t\t\tblockTypes={ blockTypes.filter(\n\t\t\t\t\t\t( { category } ) => ! category\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetBlockTypes,\n\t\t\tgetCategories,\n\t\t\thasBlockSupport,\n\t\t\tisMatchingSearchTerm,\n\t\t} = select( blocksStore );\n\t\tconst { get } = select( preferencesStore );\n\n\t\t// Some hidden blocks become unregistered\n\t\t// by removing for instance the plugin that registered them, yet\n\t\t// they're still remain as hidden by the user's action.\n\t\t// We consider \"hidden\", blocks which were hidden and\n\t\t// are still registered.\n\t\tconst blockTypes = getBlockTypes();\n\t\tconst hiddenBlockTypes = (\n\t\t\tget( 'core', 'hiddenBlockTypes' ) ?? []\n\t\t).filter( ( hiddenBlock ) => {\n\t\t\treturn blockTypes.some(\n\t\t\t\t( registeredBlock ) => registeredBlock.name === hiddenBlock\n\t\t\t);\n\t\t} );\n\t\tconst numberOfHiddenBlocks =\n\t\t\tArray.isArray( hiddenBlockTypes ) && hiddenBlockTypes.length;\n\n\t\treturn {\n\t\t\tblockTypes,\n\t\t\tcategories: getCategories(),\n\t\t\thasBlockSupport,\n\t\t\tisMatchingSearchTerm,\n\t\t\tnumberOfHiddenBlocks,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { showBlockTypes } = unlock( dispatch( editorStore ) );\n\t\treturn {\n\t\t\tenableAllBlockTypes: ( blockTypes ) => {\n\t\t\t\tconst blockNames = blockTypes.map( ( { name } ) => name );\n\t\t\t\tshowBlockTypes( blockNames );\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockManager );\n"],"mappings":"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","ignoreList":[]}