{"version":3,"names":["_blockEditor","require","_coreData","_components","_data","_i18n","_store","_lockUnlock","ContentOnlySettingsMenuItems","clientId","onClose","entity","onNavigateToEntityRecord","useSelect","select","getBlockEditingMode","getBlockParentsByBlockName","getSettings","getBlockAttributes","blockEditorStore","contentOnly","patternParent","record","coreStore","getEntityRecord","ref","getCurrentPostType","getCurrentTemplateId","editorStore","currentPostType","templateId","_react","createElement","TemplateLockContentOnlyMenuItems","isPattern","type","Fragment","__unstableBlockSettingsMenuFirstItem","MenuItem","onClick","postId","id","postType","__","__experimentalText","variant","as","className","contentLockingParent","getContentLockingParent","unlock","blockDisplayInformation","useBlockDisplayInformation","modifyContentLockBlock","selectBlock","useDispatch","title","ContentOnlySettingsMenu","BlockSettingsMenuControls","selectedClientIds","length"],"sources":["@wordpress/editor/src/components/block-settings-menu/content-only-settings-menu.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tBlockSettingsMenuControls,\n\t__unstableBlockSettingsMenuFirstItem as BlockSettingsMenuFirstItem,\n\tstore as blockEditorStore,\n\tuseBlockDisplayInformation,\n} from '@wordpress/block-editor';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { __experimentalText as Text, MenuItem } from '@wordpress/components';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { store as editorStore } from '../../store';\nimport { unlock } from '../../lock-unlock';\n\nfunction ContentOnlySettingsMenuItems( { clientId, onClose } ) {\n\tconst { entity, onNavigateToEntityRecord } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockEditingMode,\n\t\t\t\tgetBlockParentsByBlockName,\n\t\t\t\tgetSettings,\n\t\t\t\tgetBlockAttributes,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst contentOnly =\n\t\t\t\tgetBlockEditingMode( clientId ) === 'contentOnly';\n\t\t\tif ( ! contentOnly ) {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t\tconst patternParent = getBlockParentsByBlockName(\n\t\t\t\tclientId,\n\t\t\t\t'core/block',\n\t\t\t\ttrue\n\t\t\t)[ 0 ];\n\n\t\t\tlet record;\n\t\t\tif ( patternParent ) {\n\t\t\t\trecord = select( coreStore ).getEntityRecord(\n\t\t\t\t\t'postType',\n\t\t\t\t\t'wp_block',\n\t\t\t\t\tgetBlockAttributes( patternParent ).ref\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst { getCurrentPostType, getCurrentTemplateId } =\n\t\t\t\t\tselect( editorStore );\n\t\t\t\tconst currentPostType = getCurrentPostType();\n\t\t\t\tconst templateId = getCurrentTemplateId();\n\t\t\t\tif ( currentPostType === 'page' && templateId ) {\n\t\t\t\t\trecord = select( coreStore ).getEntityRecord(\n\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\ttemplateId\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tentity: record,\n\t\t\t\tonNavigateToEntityRecord:\n\t\t\t\t\tgetSettings().onNavigateToEntityRecord,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tif ( ! entity ) {\n\t\treturn (\n\t\t\t<TemplateLockContentOnlyMenuItems\n\t\t\t\tclientId={ clientId }\n\t\t\t\tonClose={ onClose }\n\t\t\t/>\n\t\t);\n\t}\n\n\tconst isPattern = entity.type === 'wp_block';\n\n\treturn (\n\t\t<>\n\t\t\t<BlockSettingsMenuFirstItem>\n\t\t\t\t<MenuItem\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tonNavigateToEntityRecord( {\n\t\t\t\t\t\t\tpostId: entity.id,\n\t\t\t\t\t\t\tpostType: entity.type,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t{ isPattern ? __( 'Edit pattern' ) : __( 'Edit template' ) }\n\t\t\t\t</MenuItem>\n\t\t\t</BlockSettingsMenuFirstItem>\n\t\t\t<Text\n\t\t\t\tvariant=\"muted\"\n\t\t\t\tas=\"p\"\n\t\t\t\tclassName=\"editor-content-only-settings-menu__description\"\n\t\t\t>\n\t\t\t\t{ isPattern\n\t\t\t\t\t? __(\n\t\t\t\t\t\t\t'Edit the pattern to move, delete, or make further changes to this block.'\n\t\t\t\t\t  )\n\t\t\t\t\t: __(\n\t\t\t\t\t\t\t'Edit the template to move, delete, or make further changes to this block.'\n\t\t\t\t\t  ) }\n\t\t\t</Text>\n\t\t</>\n\t);\n}\n\nfunction TemplateLockContentOnlyMenuItems( { clientId, onClose } ) {\n\tconst { contentLockingParent } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getContentLockingParent } = unlock(\n\t\t\t\tselect( blockEditorStore )\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tcontentLockingParent: getContentLockingParent( clientId ),\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst blockDisplayInformation =\n\t\tuseBlockDisplayInformation( contentLockingParent );\n\t// Disable reason: We're using a hook here so it has to be on top-level.\n\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\tconst { modifyContentLockBlock, selectBlock } = unlock(\n\t\tuseDispatch( blockEditorStore )\n\t);\n\n\tif ( ! blockDisplayInformation?.title ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<BlockSettingsMenuFirstItem>\n\t\t\t\t<MenuItem\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tselectBlock( contentLockingParent );\n\t\t\t\t\t\tmodifyContentLockBlock( contentLockingParent );\n\t\t\t\t\t\tonClose();\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Unlock' ) }\n\t\t\t\t</MenuItem>\n\t\t\t</BlockSettingsMenuFirstItem>\n\t\t\t<Text\n\t\t\t\tvariant=\"muted\"\n\t\t\t\tas=\"p\"\n\t\t\t\tclassName=\"editor-content-only-settings-menu__description\"\n\t\t\t>\n\t\t\t\t{ __(\n\t\t\t\t\t'Temporarily unlock the parent block to edit, delete or make further changes to this block.'\n\t\t\t\t) }\n\t\t\t</Text>\n\t\t</>\n\t);\n}\n\nexport default function ContentOnlySettingsMenu() {\n\treturn (\n\t\t<BlockSettingsMenuControls>\n\t\t\t{ ( { selectedClientIds, onClose } ) =>\n\t\t\t\tselectedClientIds.length === 1 && (\n\t\t\t\t\t<ContentOnlySettingsMenuItems\n\t\t\t\t\t\tclientId={ selectedClientIds[ 0 ] }\n\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\t\t</BlockSettingsMenuControls>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}