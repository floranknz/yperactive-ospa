{"version":3,"names":["Platform","SafeAreaView","View","SafeArea","Component","withSelect","BottomSheetSettings","FloatingToolbar","store","blockEditorStore","compose","withPreferredColorScheme","HTMLTextInput","KeyboardAvoidingView","NoticeList","Tooltip","__unstableAutocompletionItemsSlot","AutocompletionItemsSlot","AutosaveMonitor","OfflineStatus","editorStore","sendNativeEditorDidLayout","styles","headerToolbarStyles","Header","VisualEditor","Layout","constructor","arguments","onSafeAreaInsetsUpdate","bind","onRootViewLayout","state","rootViewHeight","safeAreaInsets","top","bottom","right","left","getSafeAreaInsetsForRootView","then","componentDidMount","_isMounted","safeAreaSubscription","addEventListener","componentWillUnmount","remove","result","setState","event","setHeightState","height","nativeEvent","layout","renderHTML","globalStyles","props","createElement","parentHeight","style","renderVisual","isReady","setTitleRef","render","getStylesFromColorScheme","mode","isHtmlView","marginBottom","OS","containerStyles","container","containerDark","toolbarKeyboardAvoidingViewStyle","toolbarKeyboardAvoidingView","backgroundColor","editorStyles","background","backgroundDark","Slot","onLayout","disableIntervalChecks","flex","flexBasis","withAnimatedHeight","Fragment","select","__unstableIsEditorReady","isEditorReady","getEditorMode","getSettings","__experimentalGlobalStylesBaseStyles","color"],"sources":["@wordpress/edit-post/src/components/layout/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, SafeAreaView, View } from 'react-native';\nimport SafeArea from 'react-native-safe-area';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tBottomSheetSettings,\n\tFloatingToolbar,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport {\n\tHTMLTextInput,\n\tKeyboardAvoidingView,\n\tNoticeList,\n\tTooltip,\n\t__unstableAutocompletionItemsSlot as AutocompletionItemsSlot,\n} from '@wordpress/components';\nimport {\n\tAutosaveMonitor,\n\tOfflineStatus,\n\tstore as editorStore,\n} from '@wordpress/editor';\nimport { sendNativeEditorDidLayout } from '@wordpress/react-native-bridge';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport headerToolbarStyles from '../header/header-toolbar/style.scss';\nimport Header from '../header';\nimport VisualEditor from '../visual-editor';\n\nclass Layout extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSafeAreaInsetsUpdate = this.onSafeAreaInsetsUpdate.bind( this );\n\t\tthis.onRootViewLayout = this.onRootViewLayout.bind( this );\n\n\t\tthis.state = {\n\t\t\trootViewHeight: 0,\n\t\t\tsafeAreaInsets: { top: 0, bottom: 0, right: 0, left: 0 },\n\t\t};\n\n\t\tSafeArea.getSafeAreaInsetsForRootView().then(\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tthis.safeAreaSubscription = SafeArea.addEventListener(\n\t\t\t'safeAreaInsetsForRootViewDidChange',\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.safeAreaSubscription?.remove();\n\t\tthis._isMounted = false;\n\t}\n\n\tonSafeAreaInsetsUpdate( result ) {\n\t\tconst { safeAreaInsets } = result;\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setState( { safeAreaInsets } );\n\t\t}\n\t}\n\n\tonRootViewLayout( event ) {\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setHeightState( event );\n\t\t}\n\t}\n\n\tsetHeightState( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.rootViewHeight ) {\n\t\t\tthis.setState(\n\t\t\t\t{ rootViewHeight: height },\n\t\t\t\tsendNativeEditorDidLayout\n\t\t\t);\n\t\t}\n\t}\n\n\trenderHTML() {\n\t\tconst { globalStyles } = this.props;\n\t\treturn (\n\t\t\t<HTMLTextInput\n\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\tstyle={ globalStyles }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderVisual() {\n\t\tconst { isReady } = this.props;\n\n\t\tif ( ! isReady ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <VisualEditor setTitleRef={ this.props.setTitleRef } />;\n\t}\n\n\trender() {\n\t\tconst { getStylesFromColorScheme, mode, globalStyles } = this.props;\n\n\t\tconst isHtmlView = mode === 'text';\n\n\t\t// Add a margin view at the bottom for the header.\n\t\tconst marginBottom =\n\t\t\tPlatform.OS === 'android' && ! isHtmlView\n\t\t\t\t? headerToolbarStyles[ 'header-toolbar__container' ].height\n\t\t\t\t: 0;\n\n\t\tconst containerStyles = getStylesFromColorScheme(\n\t\t\tstyles.container,\n\t\t\tstyles.containerDark\n\t\t);\n\n\t\tconst toolbarKeyboardAvoidingViewStyle = {\n\t\t\t...styles.toolbarKeyboardAvoidingView,\n\t\t\tleft: this.state.safeAreaInsets.left,\n\t\t\tright: this.state.safeAreaInsets.right,\n\t\t\tbottom: this.state.safeAreaInsets.bottom,\n\t\t\tbackgroundColor: containerStyles.backgroundColor,\n\t\t};\n\n\t\tconst editorStyles = [\n\t\t\tgetStylesFromColorScheme(\n\t\t\t\tstyles.background,\n\t\t\t\tstyles.backgroundDark\n\t\t\t),\n\t\t\tglobalStyles?.background && {\n\t\t\t\tbackgroundColor: globalStyles.background,\n\t\t\t},\n\t\t];\n\n\t\treturn (\n\t\t\t<Tooltip.Slot>\n\t\t\t\t<SafeAreaView\n\t\t\t\t\tstyle={ containerStyles }\n\t\t\t\t\tonLayout={ this.onRootViewLayout }\n\t\t\t\t>\n\t\t\t\t\t<AutosaveMonitor disableIntervalChecks />\n\t\t\t\t\t<OfflineStatus />\n\t\t\t\t\t<View style={ editorStyles }>\n\t\t\t\t\t\t{ isHtmlView ? this.renderHTML() : this.renderVisual() }\n\t\t\t\t\t\t{ ! isHtmlView && Platform.OS === 'android' && (\n\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<NoticeList />\n\t\t\t\t\t</View>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\tflex: 0,\n\t\t\t\t\t\t\tflexBasis: marginBottom,\n\t\t\t\t\t\t\theight: marginBottom,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isHtmlView && (\n\t\t\t\t\t\t<KeyboardAvoidingView\n\t\t\t\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\t\t\t\tstyle={ toolbarKeyboardAvoidingViewStyle }\n\t\t\t\t\t\t\twithAnimatedHeight\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ Platform.OS === 'ios' && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<AutocompletionItemsSlot />\n\t\t\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<Header />\n\t\t\t\t\t\t\t<BottomSheetSettings />\n\t\t\t\t\t\t</KeyboardAvoidingView>\n\t\t\t\t\t) }\n\t\t\t\t\t{ Platform.OS === 'android' && <AutocompletionItemsSlot /> }\n\t\t\t\t</SafeAreaView>\n\t\t\t</Tooltip.Slot>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { __unstableIsEditorReady: isEditorReady, getEditorMode } =\n\t\t\tselect( editorStore );\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst globalStyles =\n\t\t\tgetSettings()?.__experimentalGlobalStylesBaseStyles?.color;\n\n\t\treturn {\n\t\t\tisReady: isEditorReady(),\n\t\t\tmode: getEditorMode(),\n\t\t\tglobalStyles,\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( Layout );\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,QAAQ,EAAEC,YAAY,EAAEC,IAAI,QAAQ,cAAc;AAC3D,OAAOC,QAAQ,MAAM,wBAAwB;;AAE7C;AACA;AACA;AACA,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,UAAU,QAAQ,iBAAiB;AAC5C,SACCC,mBAAmB,EACnBC,eAAe,EACfC,KAAK,IAAIC,gBAAgB,QACnB,yBAAyB;AAChC,SAASC,OAAO,EAAEC,wBAAwB,QAAQ,oBAAoB;AACtE,SACCC,aAAa,EACbC,oBAAoB,EACpBC,UAAU,EACVC,OAAO,EACPC,iCAAiC,IAAIC,uBAAuB,QACtD,uBAAuB;AAC9B,SACCC,eAAe,EACfC,aAAa,EACbX,KAAK,IAAIY,WAAW,QACd,mBAAmB;AAC1B,SAASC,yBAAyB,QAAQ,gCAAgC;;AAE1E;AACA;AACA;AACA,OAAOC,MAAM,MAAM,cAAc;AACjC,OAAOC,mBAAmB,MAAM,qCAAqC;AACrE,OAAOC,MAAM,MAAM,WAAW;AAC9B,OAAOC,YAAY,MAAM,kBAAkB;AAE3C,MAAMC,MAAM,SAAStB,SAAS,CAAC;EAC9BuB,WAAWA,CAAA,EAAG;IACb,KAAK,CAAE,GAAGC,SAAU,CAAC;IAErB,IAAI,CAACC,sBAAsB,GAAG,IAAI,CAACA,sBAAsB,CAACC,IAAI,CAAE,IAAK,CAAC;IACtE,IAAI,CAACC,gBAAgB,GAAG,IAAI,CAACA,gBAAgB,CAACD,IAAI,CAAE,IAAK,CAAC;IAE1D,IAAI,CAACE,KAAK,GAAG;MACZC,cAAc,EAAE,CAAC;MACjBC,cAAc,EAAE;QAAEC,GAAG,EAAE,CAAC;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE,CAAC;QAAEC,IAAI,EAAE;MAAE;IACxD,CAAC;IAEDnC,QAAQ,CAACoC,4BAA4B,CAAC,CAAC,CAACC,IAAI,CAC3C,IAAI,CAACX,sBACN,CAAC;EACF;EAEAY,iBAAiBA,CAAA,EAAG;IACnB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACC,oBAAoB,GAAGxC,QAAQ,CAACyC,gBAAgB,CACpD,oCAAoC,EACpC,IAAI,CAACf,sBACN,CAAC;EACF;EAEAgB,oBAAoBA,CAAA,EAAG;IACtB,IAAI,CAACF,oBAAoB,EAAEG,MAAM,CAAC,CAAC;IACnC,IAAI,CAACJ,UAAU,GAAG,KAAK;EACxB;EAEAb,sBAAsBA,CAAEkB,MAAM,EAAG;IAChC,MAAM;MAAEb;IAAe,CAAC,GAAGa,MAAM;IACjC,IAAK,IAAI,CAACL,UAAU,EAAG;MACtB,IAAI,CAACM,QAAQ,CAAE;QAAEd;MAAe,CAAE,CAAC;IACpC;EACD;EAEAH,gBAAgBA,CAAEkB,KAAK,EAAG;IACzB,IAAK,IAAI,CAACP,UAAU,EAAG;MACtB,IAAI,CAACQ,cAAc,CAAED,KAAM,CAAC;IAC7B;EACD;EAEAC,cAAcA,CAAED,KAAK,EAAG;IACvB,MAAM;MAAEE;IAAO,CAAC,GAAGF,KAAK,CAACG,WAAW,CAACC,MAAM;IAC3C,IAAKF,MAAM,KAAK,IAAI,CAACnB,KAAK,CAACC,cAAc,EAAG;MAC3C,IAAI,CAACe,QAAQ,CACZ;QAAEf,cAAc,EAAEkB;MAAO,CAAC,EAC1B9B,yBACD,CAAC;IACF;EACD;EAEAiC,UAAUA,CAAA,EAAG;IACZ,MAAM;MAAEC;IAAa,CAAC,GAAG,IAAI,CAACC,KAAK;IACnC,OACCC,aAAA,CAAC7C,aAAa;MACb8C,YAAY,EAAG,IAAI,CAAC1B,KAAK,CAACC,cAAgB;MAC1C0B,KAAK,EAAGJ;IAAc,CACtB,CAAC;EAEJ;EAEAK,YAAYA,CAAA,EAAG;IACd,MAAM;MAAEC;IAAQ,CAAC,GAAG,IAAI,CAACL,KAAK;IAE9B,IAAK,CAAEK,OAAO,EAAG;MAChB,OAAO,IAAI;IACZ;IAEA,OAAOJ,aAAA,CAAChC,YAAY;MAACqC,WAAW,EAAG,IAAI,CAACN,KAAK,CAACM;IAAa,CAAE,CAAC;EAC/D;EAEAC,MAAMA,CAAA,EAAG;IACR,MAAM;MAAEC,wBAAwB;MAAEC,IAAI;MAAEV;IAAa,CAAC,GAAG,IAAI,CAACC,KAAK;IAEnE,MAAMU,UAAU,GAAGD,IAAI,KAAK,MAAM;;IAElC;IACA,MAAME,YAAY,GACjBnE,QAAQ,CAACoE,EAAE,KAAK,SAAS,IAAI,CAAEF,UAAU,GACtC3C,mBAAmB,CAAE,2BAA2B,CAAE,CAAC4B,MAAM,GACzD,CAAC;IAEL,MAAMkB,eAAe,GAAGL,wBAAwB,CAC/C1C,MAAM,CAACgD,SAAS,EAChBhD,MAAM,CAACiD,aACR,CAAC;IAED,MAAMC,gCAAgC,GAAG;MACxC,GAAGlD,MAAM,CAACmD,2BAA2B;MACrCnC,IAAI,EAAE,IAAI,CAACN,KAAK,CAACE,cAAc,CAACI,IAAI;MACpCD,KAAK,EAAE,IAAI,CAACL,KAAK,CAACE,cAAc,CAACG,KAAK;MACtCD,MAAM,EAAE,IAAI,CAACJ,KAAK,CAACE,cAAc,CAACE,MAAM;MACxCsC,eAAe,EAAEL,eAAe,CAACK;IAClC,CAAC;IAED,MAAMC,YAAY,GAAG,CACpBX,wBAAwB,CACvB1C,MAAM,CAACsD,UAAU,EACjBtD,MAAM,CAACuD,cACR,CAAC,EACDtB,YAAY,EAAEqB,UAAU,IAAI;MAC3BF,eAAe,EAAEnB,YAAY,CAACqB;IAC/B,CAAC,CACD;IAED,OACCnB,aAAA,CAAC1C,OAAO,CAAC+D,IAAI,QACZrB,aAAA,CAACxD,YAAY;MACZ0D,KAAK,EAAGU,eAAiB;MACzBU,QAAQ,EAAG,IAAI,CAAChD;IAAkB,GAElC0B,aAAA,CAACvC,eAAe;MAAC8D,qBAAqB;IAAA,CAAE,CAAC,EACzCvB,aAAA,CAACtC,aAAa,MAAE,CAAC,EACjBsC,aAAA,CAACvD,IAAI;MAACyD,KAAK,EAAGgB;IAAc,GACzBT,UAAU,GAAG,IAAI,CAACZ,UAAU,CAAC,CAAC,GAAG,IAAI,CAACM,YAAY,CAAC,CAAC,EACpD,CAAEM,UAAU,IAAIlE,QAAQ,CAACoE,EAAE,KAAK,SAAS,IAC1CX,aAAA,CAAClD,eAAe,MAAE,CAClB,EACDkD,aAAA,CAAC3C,UAAU,MAAE,CACR,CAAC,EACP2C,aAAA,CAACvD,IAAI;MACJyD,KAAK,EAAG;QACPsB,IAAI,EAAE,CAAC;QACPC,SAAS,EAAEf,YAAY;QACvBhB,MAAM,EAAEgB;MACT;IAAG,CACH,CAAC,EACA,CAAED,UAAU,IACbT,aAAA,CAAC5C,oBAAoB;MACpB6C,YAAY,EAAG,IAAI,CAAC1B,KAAK,CAACC,cAAgB;MAC1C0B,KAAK,EAAGa,gCAAkC;MAC1CW,kBAAkB;IAAA,GAEhBnF,QAAQ,CAACoE,EAAE,KAAK,KAAK,IACtBX,aAAA,CAAA2B,QAAA,QACC3B,aAAA,CAACxC,uBAAuB,MAAE,CAAC,EAC3BwC,aAAA,CAAClD,eAAe,MAAE,CACjB,CACF,EACDkD,aAAA,CAACjC,MAAM,MAAE,CAAC,EACViC,aAAA,CAACnD,mBAAmB,MAAE,CACD,CACtB,EACCN,QAAQ,CAACoE,EAAE,KAAK,SAAS,IAAIX,aAAA,CAACxC,uBAAuB,MAAE,CAC5C,CACD,CAAC;EAEjB;AACD;AAEA,eAAeP,OAAO,CAAE,CACvBL,UAAU,CAAIgF,MAAM,IAAM;EACzB,MAAM;IAAEC,uBAAuB,EAAEC,aAAa;IAAEC;EAAc,CAAC,GAC9DH,MAAM,CAAEjE,WAAY,CAAC;EACtB,MAAM;IAAEqE;EAAY,CAAC,GAAGJ,MAAM,CAAE5E,gBAAiB,CAAC;EAClD,MAAM8C,YAAY,GACjBkC,WAAW,CAAC,CAAC,EAAEC,oCAAoC,EAAEC,KAAK;EAE3D,OAAO;IACN9B,OAAO,EAAE0B,aAAa,CAAC,CAAC;IACxBtB,IAAI,EAAEuB,aAAa,CAAC,CAAC;IACrBjC;EACD,CAAC;AACF,CAAE,CAAC,EACH5C,wBAAwB,CACvB,CAAC,CAAEe,MAAO,CAAC","ignoreList":[]}