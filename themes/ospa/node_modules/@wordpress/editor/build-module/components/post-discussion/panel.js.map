{"version":3,"names":["__","Dropdown","Button","__experimentalVStack","VStack","__experimentalText","Text","useSelect","useState","useMemo","__experimentalInspectorPopoverHeader","InspectorPopoverHeader","store","coreStore","editorStore","PostTypeSupportCheck","PostComments","PostPingbacks","PostPanelRow","PANEL_NAME","ModalContents","onClose","createElement","className","title","spacing","supportKeys","PostDiscussionToggle","isOpen","onClick","commentStatus","pingStatus","commentsSupported","trackbacksSupported","select","_getEditedPostAttribu","_getEditedPostAttribu2","getEditedPostAttribute","getPostType","postType","supports","comments","trackbacks","label","size","variant","PostDiscussionPanel","isEnabled","isEditorPanelEnabled","popoverAnchor","setPopoverAnchor","popoverProps","anchor","placement","offset","shift","ref","contentClassName","focusOnMount","renderToggle","onToggle","renderContent"],"sources":["@wordpress/editor/src/components/post-discussion/panel.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tDropdown,\n\tButton,\n\t__experimentalVStack as VStack,\n\t__experimentalText as Text,\n} from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport { useState, useMemo } from '@wordpress/element';\nimport { __experimentalInspectorPopoverHeader as InspectorPopoverHeader } from '@wordpress/block-editor';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { store as editorStore } from '../../store';\nimport PostTypeSupportCheck from '../post-type-support-check';\nimport PostComments from '../post-comments';\nimport PostPingbacks from '../post-pingbacks';\nimport PostPanelRow from '../post-panel-row';\n\nconst PANEL_NAME = 'discussion-panel';\n\nfunction ModalContents( { onClose } ) {\n\treturn (\n\t\t<div className=\"editor-post-discussion\">\n\t\t\t<InspectorPopoverHeader\n\t\t\t\ttitle={ __( 'Discussion' ) }\n\t\t\t\tonClose={ onClose }\n\t\t\t/>\n\t\t\t<VStack spacing={ 4 }>\n\t\t\t\t<PostTypeSupportCheck supportKeys=\"comments\">\n\t\t\t\t\t<PostComments />\n\t\t\t\t</PostTypeSupportCheck>\n\t\t\t\t<PostTypeSupportCheck supportKeys=\"trackbacks\">\n\t\t\t\t\t<PostPingbacks />\n\t\t\t\t</PostTypeSupportCheck>\n\t\t\t</VStack>\n\t\t</div>\n\t);\n}\n\nfunction PostDiscussionToggle( { isOpen, onClick } ) {\n\tconst {\n\t\tcommentStatus,\n\t\tpingStatus,\n\t\tcommentsSupported,\n\t\ttrackbacksSupported,\n\t} = useSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute } = select( editorStore );\n\t\tconst { getPostType } = select( coreStore );\n\t\tconst postType = getPostType( getEditedPostAttribute( 'type' ) );\n\t\treturn {\n\t\t\tcommentStatus: getEditedPostAttribute( 'comment_status' ) ?? 'open',\n\t\t\tpingStatus: getEditedPostAttribute( 'ping_status' ) ?? 'open',\n\t\t\tcommentsSupported: !! postType.supports.comments,\n\t\t\ttrackbacksSupported: !! postType.supports.trackbacks,\n\t\t};\n\t}, [] );\n\tlet label;\n\tif ( commentStatus === 'open' ) {\n\t\tif ( pingStatus === 'open' ) {\n\t\t\tlabel = __( 'Open' );\n\t\t} else {\n\t\t\tlabel = trackbacksSupported ? __( 'Comments only' ) : __( 'Open' );\n\t\t}\n\t} else if ( pingStatus === 'open' ) {\n\t\tlabel = commentsSupported ? __( 'Pings only' ) : __( 'Pings enabled' );\n\t} else {\n\t\tlabel = __( 'Closed' );\n\t}\n\treturn (\n\t\t<Button\n\t\t\tsize=\"compact\"\n\t\t\tclassName=\"editor-post-discussion__panel-toggle\"\n\t\t\tvariant=\"tertiary\"\n\t\t\taria-label={ __( 'Change discussion options' ) }\n\t\t\taria-expanded={ isOpen }\n\t\t\tonClick={ onClick }\n\t\t>\n\t\t\t<Text>{ label }</Text>\n\t\t</Button>\n\t);\n}\n\nexport default function PostDiscussionPanel() {\n\tconst { isEnabled } = useSelect( ( select ) => {\n\t\tconst { isEditorPanelEnabled } = select( editorStore );\n\t\treturn {\n\t\t\tisEnabled: isEditorPanelEnabled( PANEL_NAME ),\n\t\t};\n\t}, [] );\n\n\t// Use internal state instead of a ref to make sure that the component\n\t// re-renders when the popover's anchor updates.\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\t// Memoize popoverProps to avoid returning a new object every time.\n\tconst popoverProps = useMemo(\n\t\t() => ( {\n\t\t\t// Anchor the popover to the middle of the entire row so that it doesn't\n\t\t\t// move around when the label changes.\n\t\t\tanchor: popoverAnchor,\n\t\t\tplacement: 'left-start',\n\t\t\toffset: 36,\n\t\t\tshift: true,\n\t\t} ),\n\t\t[ popoverAnchor ]\n\t);\n\n\tif ( ! isEnabled ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<PostTypeSupportCheck supportKeys={ [ 'comments', 'trackbacks' ] }>\n\t\t\t<PostPanelRow label={ __( 'Discussion' ) } ref={ setPopoverAnchor }>\n\t\t\t\t<Dropdown\n\t\t\t\t\tpopoverProps={ popoverProps }\n\t\t\t\t\tclassName=\"editor-post-discussion__panel-dropdown\"\n\t\t\t\t\tcontentClassName=\"editor-post-discussion__panel-dialog\"\n\t\t\t\t\tfocusOnMount\n\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t\t<PostDiscussionToggle\n\t\t\t\t\t\t\tisOpen={ isOpen }\n\t\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t\t<ModalContents onClose={ onClose } />\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</PostPanelRow>\n\t\t</PostTypeSupportCheck>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}