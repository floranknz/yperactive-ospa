{"version":3,"names":["useEntityBlockEditor","useInnerBlocksProps","InnerBlocks","store","blockEditorStore","useSelect","useMemo","PlaceholderPreview","DEFAULT_BLOCK","PRIORITIZED_INSERTER_BLOCKS","NavigationInnerBlocks","clientId","hasCustomPlaceholder","orientation","templateLock","isImmediateParentOfSelectedBlock","selectedBlockHasChildren","isSelected","select","getBlockCount","hasSelectedInnerBlock","getSelectedBlockClientId","selectedBlockId","blocks","onInput","onChange","parentOrChildHasSelection","placeholder","createElement","hasMenuItems","length","showPlaceholder","innerBlocksProps","className","value","prioritizedInserterBlocks","defaultBlock","directInsert","renderAppender","ButtonBlockAppender","undefined","__experimentalCaptureToolbars","__unstableDisableLayoutClassNames"],"sources":["@wordpress/block-library/src/navigation/edit/inner-blocks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEntityBlockEditor } from '@wordpress/core-data';\nimport {\n\tuseInnerBlocksProps,\n\tInnerBlocks,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport PlaceholderPreview from './placeholder/placeholder-preview';\nimport { DEFAULT_BLOCK, PRIORITIZED_INSERTER_BLOCKS } from '../constants';\n\nexport default function NavigationInnerBlocks( {\n\tclientId,\n\thasCustomPlaceholder,\n\torientation,\n\ttemplateLock,\n} ) {\n\tconst {\n\t\tisImmediateParentOfSelectedBlock,\n\t\tselectedBlockHasChildren,\n\t\tisSelected,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockCount,\n\t\t\t\thasSelectedInnerBlock,\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst selectedBlockId = getSelectedBlockClientId();\n\n\t\t\treturn {\n\t\t\t\tisImmediateParentOfSelectedBlock: hasSelectedInnerBlock(\n\t\t\t\t\tclientId,\n\t\t\t\t\tfalse\n\t\t\t\t),\n\t\t\t\tselectedBlockHasChildren: !! getBlockCount( selectedBlockId ),\n\n\t\t\t\t// This prop is already available but computing it here ensures it's\n\t\t\t\t// fresh compared to isImmediateParentOfSelectedBlock.\n\t\t\t\tisSelected: selectedBlockId === clientId,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_navigation'\n\t);\n\n\t// When the block is selected itself or has a top level item selected that\n\t// doesn't itself have children, show the standard appender. Else show no\n\t// appender.\n\tconst parentOrChildHasSelection =\n\t\tisSelected ||\n\t\t( isImmediateParentOfSelectedBlock && ! selectedBlockHasChildren );\n\n\tconst placeholder = useMemo( () => <PlaceholderPreview />, [] );\n\n\tconst hasMenuItems = !! blocks?.length;\n\n\t// If there is a `ref` attribute pointing to a `wp_navigation` but\n\t// that menu has no **items** (i.e. empty) then show a placeholder.\n\t// The block must also be selected else the placeholder will display\n\t// alongside the appender.\n\tconst showPlaceholder =\n\t\t! hasCustomPlaceholder && ! hasMenuItems && ! isSelected;\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{\n\t\t\tclassName: 'wp-block-navigation__container',\n\t\t},\n\t\t{\n\t\t\tvalue: blocks,\n\t\t\tonInput,\n\t\t\tonChange,\n\t\t\tprioritizedInserterBlocks: PRIORITIZED_INSERTER_BLOCKS,\n\t\t\tdefaultBlock: DEFAULT_BLOCK,\n\t\t\tdirectInsert: true,\n\t\t\torientation,\n\t\t\ttemplateLock,\n\n\t\t\t// As an exception to other blocks which feature nesting, show\n\t\t\t// the block appender even when a child block is selected.\n\t\t\t// This should be a temporary fix, to be replaced by improvements to\n\t\t\t// the sibling inserter.\n\t\t\t// See https://github.com/WordPress/gutenberg/issues/37572.\n\t\t\trenderAppender:\n\t\t\t\tisSelected ||\n\t\t\t\t( isImmediateParentOfSelectedBlock &&\n\t\t\t\t\t! selectedBlockHasChildren ) ||\n\t\t\t\t// Show the appender while dragging to allow inserting element between item and the appender.\n\t\t\t\tparentOrChildHasSelection\n\t\t\t\t\t? InnerBlocks.ButtonBlockAppender\n\t\t\t\t\t: false,\n\t\t\tplaceholder: showPlaceholder ? placeholder : undefined,\n\t\t\t__experimentalCaptureToolbars: true,\n\t\t\t__unstableDisableLayoutClassNames: true,\n\t\t}\n\t);\n\n\treturn <div { ...innerBlocksProps } />;\n}\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,oBAAoB,QAAQ,sBAAsB;AAC3D,SACCC,mBAAmB,EACnBC,WAAW,EACXC,KAAK,IAAIC,gBAAgB,QACnB,yBAAyB;AAChC,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,OAAO,QAAQ,oBAAoB;;AAE5C;AACA;AACA;AACA,OAAOC,kBAAkB,MAAM,mCAAmC;AAClE,SAASC,aAAa,EAAEC,2BAA2B,QAAQ,cAAc;AAEzE,eAAe,SAASC,qBAAqBA,CAAE;EAC9CC,QAAQ;EACRC,oBAAoB;EACpBC,WAAW;EACXC;AACD,CAAC,EAAG;EACH,MAAM;IACLC,gCAAgC;IAChCC,wBAAwB;IACxBC;EACD,CAAC,GAAGZ,SAAS,CACVa,MAAM,IAAM;IACb,MAAM;MACLC,aAAa;MACbC,qBAAqB;MACrBC;IACD,CAAC,GAAGH,MAAM,CAAEd,gBAAiB,CAAC;IAC9B,MAAMkB,eAAe,GAAGD,wBAAwB,CAAC,CAAC;IAElD,OAAO;MACNN,gCAAgC,EAAEK,qBAAqB,CACtDT,QAAQ,EACR,KACD,CAAC;MACDK,wBAAwB,EAAE,CAAC,CAAEG,aAAa,CAAEG,eAAgB,CAAC;MAE7D;MACA;MACAL,UAAU,EAAEK,eAAe,KAAKX;IACjC,CAAC;EACF,CAAC,EACD,CAAEA,QAAQ,CACX,CAAC;EAED,MAAM,CAAEY,MAAM,EAAEC,OAAO,EAAEC,QAAQ,CAAE,GAAGzB,oBAAoB,CACzD,UAAU,EACV,eACD,CAAC;;EAED;EACA;EACA;EACA,MAAM0B,yBAAyB,GAC9BT,UAAU,IACRF,gCAAgC,IAAI,CAAEC,wBAA0B;EAEnE,MAAMW,WAAW,GAAGrB,OAAO,CAAE,MAAMsB,aAAA,CAACrB,kBAAkB,MAAE,CAAC,EAAE,EAAG,CAAC;EAE/D,MAAMsB,YAAY,GAAG,CAAC,CAAEN,MAAM,EAAEO,MAAM;;EAEtC;EACA;EACA;EACA;EACA,MAAMC,eAAe,GACpB,CAAEnB,oBAAoB,IAAI,CAAEiB,YAAY,IAAI,CAAEZ,UAAU;EAEzD,MAAMe,gBAAgB,GAAG/B,mBAAmB,CAC3C;IACCgC,SAAS,EAAE;EACZ,CAAC,EACD;IACCC,KAAK,EAAEX,MAAM;IACbC,OAAO;IACPC,QAAQ;IACRU,yBAAyB,EAAE1B,2BAA2B;IACtD2B,YAAY,EAAE5B,aAAa;IAC3B6B,YAAY,EAAE,IAAI;IAClBxB,WAAW;IACXC,YAAY;IAEZ;IACA;IACA;IACA;IACA;IACAwB,cAAc,EACbrB,UAAU,IACRF,gCAAgC,IACjC,CAAEC,wBAA0B;IAC7B;IACAU,yBAAyB,GACtBxB,WAAW,CAACqC,mBAAmB,GAC/B,KAAK;IACTZ,WAAW,EAAEI,eAAe,GAAGJ,WAAW,GAAGa,SAAS;IACtDC,6BAA6B,EAAE,IAAI;IACnCC,iCAAiC,EAAE;EACpC,CACD,CAAC;EAED,OAAOd,aAAA;IAAA,GAAUI;EAAgB,CAAI,CAAC;AACvC","ignoreList":[]}