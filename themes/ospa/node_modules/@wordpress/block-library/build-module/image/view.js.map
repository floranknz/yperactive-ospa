{"version":3,"names":["store","getContext","getElement","isTouching","lastTouchTime","imageRef","buttonRef","state","actions","callbacks","currentImage","overlayOpened","currentSrc","roleAttribute","ariaModal","enlargedSrc","uploadedSrc","imgStyles","replace","showLightbox","ctx","complete","scrollTopReset","document","documentElement","scrollTop","scrollLeftReset","scrollLeft","overlayEnabled","setOverlayStyles","hideLightbox","setTimeout","focus","preventScroll","showClosingAnimation","handleKeydown","event","key","preventDefault","ref","querySelector","handleTouchMove","handleTouchStart","handleTouchEnd","Date","now","handleScroll","window","scrollTo","naturalWidth","naturalHeight","offsetWidth","originalWidth","offsetHeight","originalHeight","x","screenPosX","y","screenPosY","getBoundingClientRect","naturalRatio","originalRatio","scaleAttr","heightWithoutSpace","widthWithoutSpace","imgMaxWidth","parseFloat","targetWidth","imgMaxHeight","targetHeight","imgRatio","containerMaxWidth","containerMaxHeight","containerWidth","containerHeight","toFixed","reducedHeight","reducedWidth","horizontalPadding","innerWidth","verticalPadding","targetMaxWidth","Math","min","targetMaxHeight","innerHeight","targetContainerRatio","containerScale","lightboxImgWidth","lightboxImgHeight","overlayStyles","clientWidth","setButtonStyles","figure","parentElement","figureWidth","figureHeight","clientHeight","caption","captionComputedStyle","getComputedStyle","includes","position","marginTop","marginBottom","buttonOffsetTop","buttonOffsetRight","offsetRatio","referenceHeight","imageButtonTop","imageButtonRight","referenceWidth","setOverlayFocus","initTriggerButton","lock"],"sources":["@wordpress/block-library/src/image/view.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\n/**\n * Tracks whether user is touching screen; used to differentiate behavior for\n * touch and mouse input.\n *\n * @type {boolean}\n */\nlet isTouching = false;\n\n/**\n * Tracks the last time the screen was touched; used to differentiate behavior\n * for touch and mouse input.\n *\n * @type {number}\n */\nlet lastTouchTime = 0;\n\n/**\n * Stores the image reference of the currently opened lightbox.\n *\n * @type {HTMLElement}\n */\nlet imageRef;\n\n/**\n * Stores the button reference of the currently opened lightbox.\n *\n * @type {HTMLElement}\n */\nlet buttonRef;\n\nconst { state, actions, callbacks } = store(\n\t'core/image',\n\t{\n\t\tstate: {\n\t\t\tcurrentImage: {},\n\t\t\tget overlayOpened() {\n\t\t\t\treturn state.currentImage.currentSrc;\n\t\t\t},\n\t\t\tget roleAttribute() {\n\t\t\t\treturn state.overlayOpened ? 'dialog' : null;\n\t\t\t},\n\t\t\tget ariaModal() {\n\t\t\t\treturn state.overlayOpened ? 'true' : null;\n\t\t\t},\n\t\t\tget enlargedSrc() {\n\t\t\t\treturn (\n\t\t\t\t\tstate.currentImage.uploadedSrc ||\n\t\t\t\t\t'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='\n\t\t\t\t);\n\t\t\t},\n\t\t\tget imgStyles() {\n\t\t\t\treturn (\n\t\t\t\t\tstate.overlayOpened &&\n\t\t\t\t\t`${ state.currentImage.imgStyles?.replace(\n\t\t\t\t\t\t/;$/,\n\t\t\t\t\t\t''\n\t\t\t\t\t) }; object-fit:cover;`\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t\tactions: {\n\t\t\tshowLightbox() {\n\t\t\t\tconst ctx = getContext();\n\n\t\t\t\t// Bails out if the image has not loaded yet.\n\t\t\t\tif ( ! ctx.imageRef?.complete ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Stores the positons of the scroll to fix it until the overlay is\n\t\t\t\t// closed.\n\t\t\t\tstate.scrollTopReset = document.documentElement.scrollTop;\n\t\t\t\tstate.scrollLeftReset = document.documentElement.scrollLeft;\n\n\t\t\t\t// Moves the information of the expaned image to the state.\n\t\t\t\tctx.currentSrc = ctx.imageRef.currentSrc;\n\t\t\t\timageRef = ctx.imageRef;\n\t\t\t\tbuttonRef = ctx.buttonRef;\n\t\t\t\tstate.currentImage = ctx;\n\t\t\t\tstate.overlayEnabled = true;\n\n\t\t\t\t// Computes the styles of the overlay for the animation.\n\t\t\t\tcallbacks.setOverlayStyles();\n\t\t\t},\n\t\t\thideLightbox() {\n\t\t\t\tif ( state.overlayEnabled ) {\n\t\t\t\t\t// Waits until the close animation has completed before allowing a\n\t\t\t\t\t// user to scroll again. The duration of this animation is defined in\n\t\t\t\t\t// the `styles.scss` file, but in any case we should wait a few\n\t\t\t\t\t// milliseconds longer than the duration, otherwise a user may scroll\n\t\t\t\t\t// too soon and cause the animation to look sloppy.\n\t\t\t\t\tsetTimeout( function () {\n\t\t\t\t\t\t// Delays before changing the focus. Otherwise the focus ring will\n\t\t\t\t\t\t// appear on Firefox before the image has finished animating, which\n\t\t\t\t\t\t// looks broken.\n\t\t\t\t\t\tbuttonRef.focus( {\n\t\t\t\t\t\t\tpreventScroll: true,\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Resets the current image to mark the overlay as closed.\n\t\t\t\t\t\tstate.currentImage = {};\n\t\t\t\t\t\timageRef = null;\n\t\t\t\t\t\tbuttonRef = null;\n\t\t\t\t\t}, 450 );\n\n\t\t\t\t\t// Starts the overlay closing animation. The showClosingAnimation\n\t\t\t\t\t// class is used to avoid showing it on page load.\n\t\t\t\t\tstate.showClosingAnimation = true;\n\t\t\t\t\tstate.overlayEnabled = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleKeydown( event ) {\n\t\t\t\tif ( state.overlayEnabled ) {\n\t\t\t\t\t// Focuses the close button when the user presses the tab key.\n\t\t\t\t\tif ( event.key === 'Tab' ) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst { ref } = getElement();\n\t\t\t\t\t\tref.querySelector( 'button' ).focus();\n\t\t\t\t\t}\n\t\t\t\t\t// Closes the lightbox when the user presses the escape key.\n\t\t\t\t\tif ( event.key === 'Escape' ) {\n\t\t\t\t\t\tactions.hideLightbox();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleTouchMove( event ) {\n\t\t\t\t// On mobile devices, prevents triggering the scroll event because\n\t\t\t\t// otherwise the page jumps around when it resets the scroll position.\n\t\t\t\t// This also means that closing the lightbox requires that a user\n\t\t\t\t// perform a simple tap. This may be changed in the future if there is a\n\t\t\t\t// better alternative to override or reset the scroll position during\n\t\t\t\t// swipe actions.\n\t\t\t\tif ( state.overlayEnabled ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleTouchStart() {\n\t\t\t\tisTouching = true;\n\t\t\t},\n\t\t\thandleTouchEnd() {\n\t\t\t\t// Waits a few milliseconds before resetting to ensure that pinch to\n\t\t\t\t// zoom works consistently on mobile devices when the lightbox is open.\n\t\t\t\tlastTouchTime = Date.now();\n\t\t\t\tisTouching = false;\n\t\t\t},\n\t\t\thandleScroll() {\n\t\t\t\t// Prevents scrolling behaviors that trigger content shift while the\n\t\t\t\t// lightbox is open. It would be better to accomplish through CSS alone,\n\t\t\t\t// but using overflow: hidden is currently the only way to do so and\n\t\t\t\t// that causes a layout to shift and prevents the zoom animation from\n\t\t\t\t// working in some cases because it's not possible to account for the\n\t\t\t\t// layout shift when doing the animation calculations. Instead, it uses\n\t\t\t\t// JavaScript to prevent and reset the scrolling behavior.\n\t\t\t\tif ( state.overlayOpened ) {\n\t\t\t\t\t// Avoids overriding the scroll behavior on mobile devices because\n\t\t\t\t\t// doing so breaks the pinch to zoom functionality, and users should\n\t\t\t\t\t// be able to zoom in further on the high-res image.\n\t\t\t\t\tif ( ! isTouching && Date.now() - lastTouchTime > 450 ) {\n\t\t\t\t\t\t// It doesn't rely on `event.preventDefault()` to prevent scrolling\n\t\t\t\t\t\t// because the scroll event can't be canceled, so it resets the\n\t\t\t\t\t\t// position instead.\n\t\t\t\t\t\twindow.scrollTo(\n\t\t\t\t\t\t\tstate.scrollLeftReset,\n\t\t\t\t\t\t\tstate.scrollTopReset\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\tcallbacks: {\n\t\t\tsetOverlayStyles() {\n\t\t\t\tif ( ! imageRef ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet {\n\t\t\t\t\tnaturalWidth,\n\t\t\t\t\tnaturalHeight,\n\t\t\t\t\toffsetWidth: originalWidth,\n\t\t\t\t\toffsetHeight: originalHeight,\n\t\t\t\t} = imageRef;\n\t\t\t\tlet { x: screenPosX, y: screenPosY } =\n\t\t\t\t\timageRef.getBoundingClientRect();\n\n\t\t\t\t// Natural ratio of the image clicked to open the lightbox.\n\t\t\t\tconst naturalRatio = naturalWidth / naturalHeight;\n\t\t\t\t// Original ratio of the image clicked to open the lightbox.\n\t\t\t\tlet originalRatio = originalWidth / originalHeight;\n\n\t\t\t\t// If it has object-fit: contain, recalculates the original sizes\n\t\t\t\t// and the screen position without the blank spaces.\n\t\t\t\tif ( state.currentImage.scaleAttr === 'contain' ) {\n\t\t\t\t\tif ( naturalRatio > originalRatio ) {\n\t\t\t\t\t\tconst heightWithoutSpace = originalWidth / naturalRatio;\n\t\t\t\t\t\t// Recalculates screen position without the top space.\n\t\t\t\t\t\tscreenPosY +=\n\t\t\t\t\t\t\t( originalHeight - heightWithoutSpace ) / 2;\n\t\t\t\t\t\toriginalHeight = heightWithoutSpace;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst widthWithoutSpace = originalHeight * naturalRatio;\n\t\t\t\t\t\t// Recalculates screen position without the left space.\n\t\t\t\t\t\tscreenPosX += ( originalWidth - widthWithoutSpace ) / 2;\n\t\t\t\t\t\toriginalWidth = widthWithoutSpace;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toriginalRatio = originalWidth / originalHeight;\n\n\t\t\t\t// Typically, it uses the image's full-sized dimensions. If those\n\t\t\t\t// dimensions have not been set (i.e. an external image with only one\n\t\t\t\t// size), the image's dimensions in the lightbox are the same\n\t\t\t\t// as those of the image in the content.\n\t\t\t\tlet imgMaxWidth = parseFloat(\n\t\t\t\t\tstate.currentImage.targetWidth !== 'none'\n\t\t\t\t\t\t? state.currentImage.targetWidth\n\t\t\t\t\t\t: naturalWidth\n\t\t\t\t);\n\t\t\t\tlet imgMaxHeight = parseFloat(\n\t\t\t\t\tstate.currentImage.targetHeight !== 'none'\n\t\t\t\t\t\t? state.currentImage.targetHeight\n\t\t\t\t\t\t: naturalHeight\n\t\t\t\t);\n\n\t\t\t\t// Ratio of the biggest image stored in the database.\n\t\t\t\tlet imgRatio = imgMaxWidth / imgMaxHeight;\n\t\t\t\tlet containerMaxWidth = imgMaxWidth;\n\t\t\t\tlet containerMaxHeight = imgMaxHeight;\n\t\t\t\tlet containerWidth = imgMaxWidth;\n\t\t\t\tlet containerHeight = imgMaxHeight;\n\t\t\t\t// Checks if the target image has a different ratio than the original\n\t\t\t\t// one (thumbnail). Recalculates the width and height.\n\t\t\t\tif ( naturalRatio.toFixed( 2 ) !== imgRatio.toFixed( 2 ) ) {\n\t\t\t\t\tif ( naturalRatio > imgRatio ) {\n\t\t\t\t\t\t// If the width is reached before the height, it keeps the maxWidth\n\t\t\t\t\t\t// and recalculates the height unless the difference between the\n\t\t\t\t\t\t// maxHeight and the reducedHeight is higher than the maxWidth,\n\t\t\t\t\t\t// where it keeps the reducedHeight and recalculate the width.\n\t\t\t\t\t\tconst reducedHeight = imgMaxWidth / naturalRatio;\n\t\t\t\t\t\tif ( imgMaxHeight - reducedHeight > imgMaxWidth ) {\n\t\t\t\t\t\t\timgMaxHeight = reducedHeight;\n\t\t\t\t\t\t\timgMaxWidth = reducedHeight * naturalRatio;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\timgMaxHeight = imgMaxWidth / naturalRatio;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If the height is reached before the width, it keeps the maxHeight\n\t\t\t\t\t\t// and recalculate the width unlesss the difference between the\n\t\t\t\t\t\t// maxWidth and the reducedWidth is higher than the maxHeight, where\n\t\t\t\t\t\t// it keeps the reducedWidth and recalculate the height.\n\t\t\t\t\t\tconst reducedWidth = imgMaxHeight * naturalRatio;\n\t\t\t\t\t\tif ( imgMaxWidth - reducedWidth > imgMaxHeight ) {\n\t\t\t\t\t\t\timgMaxWidth = reducedWidth;\n\t\t\t\t\t\t\timgMaxHeight = reducedWidth / naturalRatio;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\timgMaxWidth = imgMaxHeight * naturalRatio;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcontainerWidth = imgMaxWidth;\n\t\t\t\t\tcontainerHeight = imgMaxHeight;\n\t\t\t\t\timgRatio = imgMaxWidth / imgMaxHeight;\n\n\t\t\t\t\t// Calculates the max size of the container.\n\t\t\t\t\tif ( originalRatio > imgRatio ) {\n\t\t\t\t\t\tcontainerMaxWidth = imgMaxWidth;\n\t\t\t\t\t\tcontainerMaxHeight = containerMaxWidth / originalRatio;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontainerMaxHeight = imgMaxHeight;\n\t\t\t\t\t\tcontainerMaxWidth = containerMaxHeight * originalRatio;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If the image has been pixelated on purpose, it keeps that size.\n\t\t\t\tif (\n\t\t\t\t\toriginalWidth > containerWidth ||\n\t\t\t\t\toriginalHeight > containerHeight\n\t\t\t\t) {\n\t\t\t\t\tcontainerWidth = originalWidth;\n\t\t\t\t\tcontainerHeight = originalHeight;\n\t\t\t\t}\n\n\t\t\t\t// Calculates the final lightbox image size and the scale factor.\n\t\t\t\t// MaxWidth is either the window container (accounting for padding) or\n\t\t\t\t// the image resolution.\n\t\t\t\tlet horizontalPadding = 0;\n\t\t\t\tif ( window.innerWidth > 480 ) {\n\t\t\t\t\thorizontalPadding = 80;\n\t\t\t\t} else if ( window.innerWidth > 1920 ) {\n\t\t\t\t\thorizontalPadding = 160;\n\t\t\t\t}\n\t\t\t\tconst verticalPadding = 80;\n\n\t\t\t\tconst targetMaxWidth = Math.min(\n\t\t\t\t\twindow.innerWidth - horizontalPadding,\n\t\t\t\t\tcontainerWidth\n\t\t\t\t);\n\t\t\t\tconst targetMaxHeight = Math.min(\n\t\t\t\t\twindow.innerHeight - verticalPadding,\n\t\t\t\t\tcontainerHeight\n\t\t\t\t);\n\t\t\t\tconst targetContainerRatio = targetMaxWidth / targetMaxHeight;\n\n\t\t\t\tif ( originalRatio > targetContainerRatio ) {\n\t\t\t\t\t// If targetMaxWidth is reached before targetMaxHeight.\n\t\t\t\t\tcontainerWidth = targetMaxWidth;\n\t\t\t\t\tcontainerHeight = containerWidth / originalRatio;\n\t\t\t\t} else {\n\t\t\t\t\t// If targetMaxHeight is reached before targetMaxWidth.\n\t\t\t\t\tcontainerHeight = targetMaxHeight;\n\t\t\t\t\tcontainerWidth = containerHeight * originalRatio;\n\t\t\t\t}\n\n\t\t\t\tconst containerScale = originalWidth / containerWidth;\n\t\t\t\tconst lightboxImgWidth =\n\t\t\t\t\timgMaxWidth * ( containerWidth / containerMaxWidth );\n\t\t\t\tconst lightboxImgHeight =\n\t\t\t\t\timgMaxHeight * ( containerHeight / containerMaxHeight );\n\n\t\t\t\t// As of this writing, using the calculations above will render the\n\t\t\t\t// lightbox with a small, erroneous whitespace on the left side of the\n\t\t\t\t// image in iOS Safari, perhaps due to an inconsistency in how browsers\n\t\t\t\t// handle absolute positioning and CSS transformation. In any case,\n\t\t\t\t// adding 1 pixel to the container width and height solves the problem,\n\t\t\t\t// though this can be removed if the issue is fixed in the future.\n\t\t\t\tstate.overlayStyles = `\n\t\t\t\t:root {\n\t\t\t\t\t--wp--lightbox-initial-top-position: ${ screenPosY }px;\n\t\t\t\t\t--wp--lightbox-initial-left-position: ${ screenPosX }px;\n\t\t\t\t\t--wp--lightbox-container-width: ${ containerWidth + 1 }px;\n\t\t\t\t\t--wp--lightbox-container-height: ${ containerHeight + 1 }px;\n\t\t\t\t\t--wp--lightbox-image-width: ${ lightboxImgWidth }px;\n\t\t\t\t\t--wp--lightbox-image-height: ${ lightboxImgHeight }px;\n\t\t\t\t\t--wp--lightbox-scale: ${ containerScale };\n\t\t\t\t\t--wp--lightbox-scrollbar-width: ${\n\t\t\t\t\t\twindow.innerWidth - document.documentElement.clientWidth\n\t\t\t\t\t}px;\n\t\t\t\t}\n\t\t\t`;\n\t\t\t},\n\t\t\tsetButtonStyles() {\n\t\t\t\tconst ctx = getContext();\n\t\t\t\tconst { ref } = getElement();\n\t\t\t\tctx.imageRef = ref;\n\n\t\t\t\tconst {\n\t\t\t\t\tnaturalWidth,\n\t\t\t\t\tnaturalHeight,\n\t\t\t\t\toffsetWidth,\n\t\t\t\t\toffsetHeight,\n\t\t\t\t} = ref;\n\n\t\t\t\t// If the image isn't loaded yet, it can't calculate where the button\n\t\t\t\t// should be.\n\t\t\t\tif ( naturalWidth === 0 || naturalHeight === 0 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst figure = ref.parentElement;\n\t\t\t\tconst figureWidth = ref.parentElement.clientWidth;\n\n\t\t\t\t// It needs special handling for the height because a caption will cause\n\t\t\t\t// the figure to be taller than the image, which means it needs to\n\t\t\t\t// account for that when calculating the placement of the button in the\n\t\t\t\t// top right corner of the image.\n\t\t\t\tlet figureHeight = ref.parentElement.clientHeight;\n\t\t\t\tconst caption = figure.querySelector( 'figcaption' );\n\t\t\t\tif ( caption ) {\n\t\t\t\t\tconst captionComputedStyle =\n\t\t\t\t\t\twindow.getComputedStyle( caption );\n\t\t\t\t\tif (\n\t\t\t\t\t\t! [ 'absolute', 'fixed' ].includes(\n\t\t\t\t\t\t\tcaptionComputedStyle.position\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tfigureHeight =\n\t\t\t\t\t\t\tfigureHeight -\n\t\t\t\t\t\t\tcaption.offsetHeight -\n\t\t\t\t\t\t\tparseFloat( captionComputedStyle.marginTop ) -\n\t\t\t\t\t\t\tparseFloat( captionComputedStyle.marginBottom );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst buttonOffsetTop = figureHeight - offsetHeight;\n\t\t\t\tconst buttonOffsetRight = figureWidth - offsetWidth;\n\n\t\t\t\t// In the case of an image with object-fit: contain, the size of the\n\t\t\t\t// <img> element can be larger than the image itself, so it needs to\n\t\t\t\t// calculate where to place the button.\n\t\t\t\tif ( ctx.scaleAttr === 'contain' ) {\n\t\t\t\t\t// Natural ratio of the image.\n\t\t\t\t\tconst naturalRatio = naturalWidth / naturalHeight;\n\t\t\t\t\t// Offset ratio of the image.\n\t\t\t\t\tconst offsetRatio = offsetWidth / offsetHeight;\n\n\t\t\t\t\tif ( naturalRatio >= offsetRatio ) {\n\t\t\t\t\t\t// If it reaches the width first, it keeps the width and compute the\n\t\t\t\t\t\t// height.\n\t\t\t\t\t\tconst referenceHeight = offsetWidth / naturalRatio;\n\t\t\t\t\t\tctx.imageButtonTop =\n\t\t\t\t\t\t\t( offsetHeight - referenceHeight ) / 2 +\n\t\t\t\t\t\t\tbuttonOffsetTop +\n\t\t\t\t\t\t\t16;\n\t\t\t\t\t\tctx.imageButtonRight = buttonOffsetRight + 16;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If it reaches the height first, it keeps the height and compute\n\t\t\t\t\t\t// the width.\n\t\t\t\t\t\tconst referenceWidth = offsetHeight * naturalRatio;\n\t\t\t\t\t\tctx.imageButtonTop = buttonOffsetTop + 16;\n\t\t\t\t\t\tctx.imageButtonRight =\n\t\t\t\t\t\t\t( offsetWidth - referenceWidth ) / 2 +\n\t\t\t\t\t\t\tbuttonOffsetRight +\n\t\t\t\t\t\t\t16;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tctx.imageButtonTop = buttonOffsetTop + 16;\n\t\t\t\t\tctx.imageButtonRight = buttonOffsetRight + 16;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetOverlayFocus() {\n\t\t\t\tif ( state.overlayEnabled ) {\n\t\t\t\t\t// Moves the focus to the dialog when it opens.\n\t\t\t\t\tconst { ref } = getElement();\n\t\t\t\t\tref.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tinitTriggerButton() {\n\t\t\t\tconst ctx = getContext();\n\t\t\t\tconst { ref } = getElement();\n\t\t\t\tctx.buttonRef = ref;\n\t\t\t},\n\t\t},\n\t},\n\t{ lock: true }\n);\n"],"mappings":"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","ignoreList":[]}